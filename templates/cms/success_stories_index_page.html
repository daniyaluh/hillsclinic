{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block title %}{{ page.title }} - Hills Clinic{% endblock %}

{% block content %}
<!-- Hero -->
<section class="bg-gradient-to-br from-stone-900 via-stone-800 to-stone-900 text-white py-20">
    <div class="container mx-auto px-4 text-center">
        <h1 class="text-4xl md:text-5xl font-serif font-bold mb-4">{{ page.title }}</h1>
        <p class="text-xl text-stone-300 max-w-2xl mx-auto">
            {% if page.introduction %}
            {{ page.introduction|striptags|truncatewords:25 }}
            {% else %}
            Real stories from patients who transformed their lives through limb lengthening surgery
            {% endif %}
        </p>
    </div>
</section>

<!-- Stats -->
<section class="py-12 bg-white border-b border-stone-200">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
            <div>
                <div class="text-4xl font-bold text-amber-600">500+</div>
                <div class="text-stone-500 text-sm mt-1">Successful Surgeries</div>
            </div>
            <div>
                <div class="text-4xl font-bold text-emerald-600">20+</div>
                <div class="text-stone-500 text-sm mt-1">Countries</div>
            </div>
            <div>
                <div class="text-4xl font-bold text-stone-700">98%</div>
                <div class="text-stone-500 text-sm mt-1">Satisfaction Rate</div>
            </div>
            <div>
                <div class="text-4xl font-bold text-stone-500">40+</div>
                <div class="text-stone-500 text-sm mt-1">Years Experience</div>
            </div>
        </div>
    </div>
</section>

<!-- Introduction -->
{% if page.introduction %}
<section class="py-12 bg-stone-50">
    <div class="container mx-auto px-4">
        <div class="prose prose-lg prose-stone max-w-3xl mx-auto text-center">
            {{ page.introduction|richtext }}
        </div>
    </div>
</section>
{% endif %}

<!-- Success Stories Grid -->
<section class="py-20 bg-stone-50">
    <div class="container mx-auto px-4">
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
            {% for story in stories %}
            <article class="bg-white rounded-3xl ring-1 ring-stone-200 overflow-hidden hover:ring-amber-300 hover:shadow-lg transition-all group">
                <!-- Image -->
                <div class="h-64 bg-stone-100 overflow-hidden relative">
                    {% if story.featured_image %}
                    {% image story.featured_image fill-400x300 as thumb %}
                    <img src="{{ thumb.url }}" alt="{{ story.title }}" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300">
                    {% else %}
                    <div class="w-full h-full bg-gradient-to-br from-amber-100 to-amber-200 flex items-center justify-center">
                        <div class="text-center">
                            <div class="w-20 h-20 bg-white rounded-2xl flex items-center justify-center mx-auto mb-3 shadow-sm">
                                <span class="text-2xl font-bold text-amber-600">{{ story.patient_initials|default:"P" }}</span>
                            </div>
                            {% if story.location %}
                            <span class="text-amber-700 text-sm font-medium">{{ story.location }}</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                    
                    <!-- Height Gain Badge -->
                    {% if story.height_gained %}
                    <div class="absolute top-4 right-4 bg-amber-600 text-white px-3 py-1 rounded-full text-sm font-bold">
                        +{{ story.height_gained }}
                    </div>
                    {% endif %}
                </div>
                
                <!-- Content -->
                <div class="p-6">
                    {% if story.procedure_method %}
                    <span class="inline-block px-3 py-1 bg-stone-100 text-stone-600 rounded-full text-xs font-medium mb-3">
                        {{ story.procedure_method }}
                    </span>
                    {% elif story.procedure_type %}
                    <span class="inline-block px-3 py-1 bg-stone-100 text-stone-600 rounded-full text-xs font-medium mb-3">
                        {{ story.procedure_type }}
                    </span>
                    {% endif %}
                    
                    <h3 class="text-xl font-semibold text-stone-900 mb-2 group-hover:text-amber-700 transition-colors">
                        {% if story.title %}
                        {{ story.title }}
                        {% else %}
                        Patient {{ story.patient_initials }}{% if story.age %}, {{ story.age }}{% endif %}
                        {% endif %}
                    </h3>
                    
                    {% if story.patient_country or story.location %}
                    <p class="text-stone-500 text-sm mb-3">
                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                        {{ story.patient_country|default:story.location }}
                    </p>
                    {% endif %}
                    
                    <p class="text-stone-600 text-sm line-clamp-3 mb-4">
                        {% if story.testimonial_quote %}
                        "{{ story.testimonial_quote }}"
                        {% elif story.excerpt %}
                        {{ story.excerpt|striptags|truncatewords:25 }}
                        {% elif story.body %}
                        {{ story.body|striptags|truncatewords:25 }}
                        {% endif %}
                    </p>
                    
                    {% if story.get_url %}
                    <a href="{% pageurl story %}" class="text-amber-700 hover:text-amber-800 font-medium text-sm inline-flex items-center">
                        Read Full Story
                        <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                    </a>
                    {% endif %}
                </div>
            </article>
            {% empty %}
            <div class="col-span-full text-center py-16">
                <svg class="w-16 h-16 text-stone-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                </svg>
                <h3 class="text-xl font-semibold text-stone-900 mb-2">No stories yet</h3>
                <p class="text-stone-600">Success stories will be added soon.</p>
            </div>
            {% endfor %}
        </div>
        
        <!-- Pagination -->
        {% if stories.paginator.num_pages > 1 %}
        <nav class="mt-12 flex justify-center">
            <div class="flex items-center gap-2">
                {% if stories.has_previous %}
                <a href="?page={{ stories.previous_page_number }}" class="px-4 py-2 bg-white ring-1 ring-stone-200 rounded-full text-stone-700 hover:bg-stone-50 transition">Previous</a>
                {% endif %}
                
                <span class="px-4 py-2 text-stone-600">
                    Page {{ stories.number }} of {{ stories.paginator.num_pages }}
                </span>
                
                {% if stories.has_next %}
                <a href="?page={{ stories.next_page_number }}" class="px-4 py-2 bg-amber-600 text-white rounded-full hover:bg-amber-700 transition">Next</a>
                {% endif %}
            </div>
        </nav>
        {% endif %}
    </div>
</section>

<!-- Testimonial Quote -->
<section class="py-16 bg-white">
    <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto text-center">
            <svg class="w-12 h-12 text-amber-300 mx-auto mb-6" fill="currentColor" viewBox="0 0 24 24">
                <path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"/>
            </svg>
            <blockquote class="text-2xl md:text-3xl font-serif text-stone-700 italic mb-6">
                "This surgery changed my life. The team at Hills Clinic made me feel supported every step of the way."
            </blockquote>
            <cite class="text-stone-500 not-italic">â€” A satisfied patient from Dubai</cite>
        </div>
    </div>
</section>

<!-- CTA -->
<section class="py-16 bg-gradient-to-br from-stone-900 via-stone-800 to-stone-900 text-white">
    <div class="container mx-auto px-4 text-center">
        <h2 class="text-3xl font-serif font-bold mb-4">Start Your Success Story</h2>
        <p class="text-xl text-stone-300 mb-8 max-w-2xl mx-auto">Join the hundreds of patients who have transformed their lives. Schedule a consultation today.</p>
        <a href="{% url 'booking:consultation' %}" class="inline-flex items-center px-8 py-4 bg-amber-600 text-white font-semibold rounded-full hover:bg-amber-700 transition-all shadow-lg shadow-amber-600/25">
            Book Consultation
            <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
            </svg>
        </a>
    </div>
</section>
{% endblock %}
