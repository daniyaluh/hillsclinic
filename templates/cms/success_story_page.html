{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block title %}{{ page.title }} - Hills Clinic{% endblock %}

{% block extra_head %}
<!-- Article Schema -->
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "{{ page.title }}",
    "datePublished": "{{ page.first_published_at|date:'c' }}",
    "publisher": {
        "@type": "Organization",
        "name": "Hills Clinic"
    }
}
</script>
{% endblock %}

{% block content %}
<!-- Hero with Image -->
<section class="relative bg-gradient-to-br from-stone-900 via-stone-800 to-stone-900 text-white">
    <div class="container mx-auto px-4 py-20">
        <nav class="text-sm mb-4" aria-label="Breadcrumb">
            <ol class="flex items-center space-x-2 text-stone-400">
                <li><a href="/" class="hover:text-amber-500 transition-colors">Home</a></li>
                <li><span class="mx-2">/</span></li>
                <li><a href="{{ page.get_parent.url }}" class="hover:text-amber-500 transition-colors">Success Stories</a></li>
                <li><span class="mx-2">/</span></li>
                <li class="text-stone-200">{{ page.title }}</li>
            </ol>
        </nav>
        
        <div class="max-w-3xl">
            {% if page.procedure_type %}
            <span class="inline-block px-4 py-1 bg-amber-600/20 text-amber-400 rounded-full text-sm font-medium mb-4 border border-amber-600/30">
                {{ page.procedure_type }}
            </span>
            {% endif %}
            
            <h1 class="text-3xl md:text-4xl lg:text-5xl font-serif font-bold mb-4">{{ page.title }}</h1>
            
            <div class="flex flex-wrap items-center gap-4 text-stone-300">
                {% if page.patient_country %}
                <span class="flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                    </svg>
                    {{ page.patient_country }}
                </span>
                {% endif %}
                {% if page.height_gained %}
                <span class="flex items-center text-amber-400 font-semibold">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"/>
                    </svg>
                    +{{ page.height_gained }} height gained
                </span>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- Patient Stats -->
{% if page.height_gained or page.surgery_date or page.procedure_type %}
<section class="bg-white py-8 border-b border-stone-200">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
            {% if page.height_gained %}
            <div class="p-4">
                <div class="text-3xl font-bold text-amber-600">+{{ page.height_gained }}</div>
                <div class="text-stone-500 text-sm">Height Gained</div>
            </div>
            {% endif %}
            {% if page.procedure_type %}
            <div class="p-4">
                <div class="text-xl font-bold text-stone-700">{{ page.procedure_type }}</div>
                <div class="text-stone-500 text-sm">Procedure</div>
            </div>
            {% endif %}
            {% if page.surgery_date %}
            <div class="p-4">
                <div class="text-xl font-bold text-stone-700">{{ page.surgery_date|date:"M Y" }}</div>
                <div class="text-stone-500 text-sm">Surgery Date</div>
            </div>
            {% endif %}
            {% if page.patient_age %}
            <div class="p-4">
                <div class="text-xl font-bold text-stone-700">{{ page.patient_age }}</div>
                <div class="text-stone-500 text-sm">Age at Surgery</div>
            </div>
            {% endif %}
        </div>
    </div>
</section>
{% endif %}

<!-- Featured Image -->
{% if page.featured_image %}
<div class="container mx-auto px-4 my-12">
    <div class="max-w-4xl mx-auto">
        {% image page.featured_image width-1000 as img %}
        <img src="{{ img.url }}" alt="{{ page.title }}" class="w-full rounded-3xl shadow-lg ring-1 ring-stone-200">
    </div>
</div>
{% endif %}

<!-- Story Content -->
<article class="py-12">
    <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
            <div class="grid lg:grid-cols-12 gap-12">
                <!-- Social Share Sidebar -->
                <aside class="hidden lg:block lg:col-span-1">
                    <div class="sticky top-24 flex flex-col gap-3">
                        <span class="text-xs text-stone-400 font-medium">SHARE</span>
                        <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri|urlencode }}&text={{ page.title|urlencode }}" 
                           target="_blank"
                           class="w-10 h-10 bg-stone-100 hover:bg-amber-100 rounded-full flex items-center justify-center text-stone-600 hover:text-amber-700 transition-colors">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                        </a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri|urlencode }}" 
                           target="_blank"
                           class="w-10 h-10 bg-stone-100 hover:bg-amber-100 rounded-full flex items-center justify-center text-stone-600 hover:text-amber-700 transition-colors">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
                        </a>
                        <a href="https://wa.me/?text={{ page.title|urlencode }}%20{{ request.build_absolute_uri|urlencode }}" 
                           target="_blank"
                           class="w-10 h-10 bg-stone-100 hover:bg-amber-100 rounded-full flex items-center justify-center text-stone-600 hover:text-amber-700 transition-colors">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
                        </a>
                    </div>
                </aside>
                
                <!-- Story Body -->
                <div class="lg:col-span-11">
                    <!-- Quote Highlight -->
                    {% if page.quote %}
                    <blockquote class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-3xl ring-1 ring-amber-200 p-8 mb-8">
                        <svg class="w-8 h-8 text-amber-400 mb-4" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"/>
                        </svg>
                        <p class="text-xl md:text-2xl font-serif text-stone-700 italic">{{ page.quote }}</p>
                    </blockquote>
                    {% endif %}
                    
                    <!-- Main Content -->
                    <div class="prose prose-lg prose-stone max-w-none">
                        {{ page.body|richtext }}
                    </div>
                    
                    <!-- Before/After Gallery -->
                    {% if page.gallery_images.all %}
                    <div class="mt-12">
                        <h2 class="text-2xl font-serif font-bold text-stone-900 mb-6">Before & After</h2>
                        <div class="grid md:grid-cols-2 gap-4">
                            {% for item in page.gallery_images.all %}
                            {% image item.image width-500 as gallery_img %}
                            <div class="rounded-2xl overflow-hidden ring-1 ring-stone-200">
                                <img src="{{ gallery_img.url }}" alt="{{ item.caption|default:'Patient photo' }}" class="w-full">
                                {% if item.caption %}
                                <p class="p-3 text-sm text-stone-600 bg-stone-50">{{ item.caption }}</p>
                                {% endif %}
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    
                    <!-- Mobile Share -->
                    <div class="lg:hidden mt-12 pt-8 border-t border-stone-200">
                        <p class="text-stone-500 text-sm mb-4">Share this story</p>
                        <div class="flex gap-3">
                            <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri|urlencode }}&text={{ page.title|urlencode }}" target="_blank" class="w-10 h-10 bg-stone-100 hover:bg-amber-100 rounded-full flex items-center justify-center text-stone-600 hover:text-amber-700">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                            </a>
                            <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri|urlencode }}" target="_blank" class="w-10 h-10 bg-stone-100 hover:bg-amber-100 rounded-full flex items-center justify-center text-stone-600 hover:text-amber-700">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
                            </a>
                            <a href="https://wa.me/?text={{ page.title|urlencode }}%20{{ request.build_absolute_uri|urlencode }}" target="_blank" class="w-10 h-10 bg-stone-100 hover:bg-amber-100 rounded-full flex items-center justify-center text-stone-600 hover:text-amber-700">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</article>

<!-- More Stories -->
{% if related_stories %}
<section class="py-16 bg-stone-50 border-t border-stone-200">
    <div class="container mx-auto px-4">
        <h2 class="text-2xl font-serif font-bold text-stone-900 mb-8 text-center">More Success Stories</h2>
        <div class="grid md:grid-cols-3 gap-8 max-w-5xl mx-auto">
            {% for story in related_stories %}
            <article class="bg-white rounded-2xl ring-1 ring-stone-200 overflow-hidden hover:ring-amber-300 hover:shadow-lg transition-all">
                <div class="h-40 bg-stone-100 overflow-hidden">
                    {% if story.featured_image %}
                    {% image story.featured_image fill-400x200 as thumb %}
                    <img src="{{ thumb.url }}" alt="{{ story.title }}" class="w-full h-full object-cover">
                    {% endif %}
                </div>
                <div class="p-5">
                    <h3 class="font-semibold text-stone-900 mb-2 line-clamp-2 hover:text-amber-700 transition-colors">
                        <a href="{% pageurl story %}">{{ story.title }}</a>
                    </h3>
                    {% if story.height_gained %}
                    <span class="text-amber-600 text-sm font-medium">+{{ story.height_gained }}</span>
                    {% endif %}
                </div>
            </article>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<!-- CTA -->
<section class="py-16 bg-gradient-to-br from-stone-900 via-stone-800 to-stone-900 text-white">
    <div class="container mx-auto px-4 text-center">
        <h2 class="text-3xl font-serif font-bold mb-4">Write Your Own Success Story</h2>
        <p class="text-xl text-stone-300 mb-8 max-w-2xl mx-auto">Take the first step towards your transformation today.</p>
        <a href="{% url 'booking:consultation' %}" class="inline-flex items-center px-8 py-4 bg-amber-600 text-white font-semibold rounded-full hover:bg-amber-700 transition-all shadow-lg shadow-amber-600/25">
            Book Consultation
            <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
            </svg>
        </a>
    </div>
</section>
{% endblock %}
